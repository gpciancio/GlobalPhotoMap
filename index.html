
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>GlobalPhotoMap</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <style>
     /* Always set the map height explicitly to define the size of the div
      * element that contains the map. */
     #map {
       height: 55%;
     }
     /* Optional: Makes the sample page fill the window. */
     html, body {
       height: 100%;
       margin: 0;
       padding: 0;
     }
   </style>
   <!--Import jQuery before materialize.js-->
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="scripts.js"></script>

  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/css/materialize.min.css">

  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/js/materialize.min.js"></script>
  </head>
  <body>

<!-- //Nav bar set up -->
    <container>
      <nav class="nav-extended light-blue accent-2 material-icons">
        <div class="nav-wrapper light-blue darken-4">
          <a class="brand-logo center"><img "width=100px height=100px" src="http://iconshow.me/media/images/ui/Flat-icon/png/256/compass.png"></a>
          <a href="#" data-activates="mobile-demo" class="button-collapse"><i class="material-icons">Menu</i></a>
          <ul class="right hide-on-med-and-down">
            <li><a target="_blank" href="https://www.google.com/maps">Google Maps</a></li>
            <li><a target="_blank" href="https://www.flickr.com/">Flickr</a></li>
          </ul>
          <ul class="side-nav purple lighten-2" id="mobile-demo">
            <li><a href="sass.html">Google Maps</a></li>
            <li><a href="badges.html">Flickr</a></li>

          </ul>
        </div>
        <div class="nav-content">
          <div id=#navtitle class="nav-title strong black-text">Global Photo Map</div>
          <a class="btn-floating btn-large halfway-fab waves-effect light-green darken-1">
            <i href="/Users/GP/projects/q1/USPhotoMap/index1.html" class="material-icons">GPM</i>
          </a>
        </div>
      </nav>

    </container>
<!-- Geolocation------------->
<div id="map"></div>
<div id="photos"></div>
<script>
// set up our variables
var latitude = null;
var longitude = null;

// set up our CONFIG Obect to access our API keys
var config = {};
// load my config.json file that has my API info
$.getJSON("config.json", function(result) {
  config = result;
});

// find the '#below' element in our html in order to update if photos are loaded
var photosElement = document.getElementById('photos');

  // google map is initialized and laoded with preset config -- center and zoom
  var map, infoWindow;
  function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
       center: {lat: 40.446, lng: -94.570},
       zoom: 3
    });

    // click event listening for a click on the map
    map.addListener("click", function (event) {
      // set the lat and lon of the click coordinates
      latitude = event.latLng.lat();
      longitude = event.latLng.lng();


      // set up requestUrl with lat and lon variables and API key variable
      var requestUrl = `https://api.flickr.com/services/rest/?method=flickr.photos.search&lat=${latitude}&lon=${longitude}&api_key=${config['flickerApiKey']}&format=json&nojsoncallback=1`;

      // make request to Flicker using requestUrl to get photos by lat and lon
      $.get(requestUrl, function(result) {
        // TODO -- loop through the result.photos.photo array to get all the photos
        var farmId;
        var serverId;
        var secret;
        var imageUrl;

        // set variables to be used to build the image url to display the images
        farmId = result.photos.photo[0].farm;
        serverId = result.photos.photo[0].server;
        id = result.photos.photo[0].id;
        secret = result.photos.photo[0].secret;

        // imageUrl that will be used to display the image in the html below the map
        imageUrl = `https://farm${farmId}.staticflickr.com/${serverId}/${id}_${secret}.jpg`

        // create the image element so it can be appended to the #below element -- 'elem'
        var img = document.createElement("IMG");
        img.setAttribute('src', imageUrl);
        img.setAttribute('width', '200px');
        img.setAttribute('height', '200px');
        photosElement.appendChild(img);
        // $('#below').html(`<img src=${imageUrl} height="64px" width="64px">`)

      });

    });

  };
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCLkyxK-2pRusMpOy3ZrDWRnnq9iE1kpGI&callback=initMap">

</script>
<!-- HTML Here -->


  </body>
</html>
